local NotificationLibrary = {}

-- Configuration
local CONFIG = {
	DURATION = 5,
	SLIDE_TIME = 0.6,
	ICONS = {
		error = "rbxassetid://2777727756",
		success = "rbxassetid://2790552399",
		info = "rbxassetid://2790676563"
	},
	COLORS = {
		error = Color3.fromRGB(239, 68, 68),
		success = Color3.fromRGB(34, 197, 94),
		info = Color3.fromRGB(59, 130, 246)
	},
	BACKGROUND = Color3.fromRGB(24, 24, 27),
	BORDER = Color3.fromRGB(39, 39, 42)
}

-- Helper function to create UI elements
local function create(className, properties)
	local instance = Instance.new(className)
	for prop, value in pairs(properties) do
		instance[prop] = value
	end
	return instance
end

function NotificationLibrary:CreateNotification(title, body, notifType)
	-- Validate notification type
	if not CONFIG.COLORS[notifType] then
		warn("Invalid notification type. Use: error, success, or info")
		return
	end
	
	-- Remove existing notification
	local playerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")
	local existing = playerGui:FindFirstChild("ModernNotification")
	if existing then
		existing:Destroy()
	end
	
	-- Create ScreenGui
	local screenGui = create("ScreenGui", {
		Name = "ModernNotification",
		Parent = playerGui,
		ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
		ResetOnSpawn = false
	})
	
	-- Main notification frame
	local notification = create("Frame", {
		Name = "Notification",
		Parent = screenGui,
		BackgroundColor3 = CONFIG.BACKGROUND,
		BorderSizePixel = 0,
		Position = UDim2.new(1.1, 0, 0.02, 0),
		Size = UDim2.new(0, 380, 0, 100),
		ClipsDescendants = true
	})
	
	-- Corner radius
	create("UICorner", {
		CornerRadius = UDim.new(0, 12),
		Parent = notification
	})
	
	-- Accent border
	local border = create("Frame", {
		Name = "AccentBorder",
		Parent = notification,
		BackgroundColor3 = CONFIG.COLORS[notifType],
		BorderSizePixel = 0,
		Position = UDim2.new(0, 0, 0, 0),
		Size = UDim2.new(0, 4, 1, 0)
	})
	
	-- Shadow effect (using multiple frames for depth)
	for i = 1, 3 do
		create("Frame", {
			Name = "Shadow" .. i,
			Parent = notification,
			BackgroundColor3 = Color3.fromRGB(0, 0, 0),
			BackgroundTransparency = 0.7 + (i * 0.1),
			BorderSizePixel = 0,
			Position = UDim2.new(0, -i, 0, -i),
			Size = UDim2.new(1, i * 2, 1, i * 2),
			ZIndex = -i
		}).Parent = screenGui
	end
	
	-- Icon container
	local iconContainer = create("Frame", {
		Name = "IconContainer",
		Parent = notification,
		BackgroundColor3 = CONFIG.COLORS[notifType],
		BackgroundTransparency = 0.9,
		Position = UDim2.new(0, 16, 0.5, -20),
		Size = UDim2.new(0, 40, 0, 40)
	})
	
	create("UICorner", {
		CornerRadius = UDim.new(0, 8),
		Parent = iconContainer
	})
	
	create("ImageLabel", {
		Name = "Icon",
		Parent = iconContainer,
		BackgroundTransparency = 1,
		Position = UDim2.new(0.5, -12, 0.5, -12),
		Size = UDim2.new(0, 24, 0, 24),
		Image = CONFIG.ICONS[notifType],
		ImageColor3 = CONFIG.COLORS[notifType],
		ScaleType = Enum.ScaleType.Fit
	})
	
	-- Title
	create("TextLabel", {
		Name = "Title",
		Parent = notification,
		BackgroundTransparency = 1,
		Position = UDim2.new(0, 68, 0, 16),
		Size = UDim2.new(1, -88, 0, 24),
		Font = Enum.Font.GothamBold,
		Text = title,
		TextColor3 = Color3.fromRGB(250, 250, 250),
		TextSize = 16,
		TextXAlignment = Enum.TextXAlignment.Left,
		TextTruncate = Enum.TextTruncateMode.AtEnd
	})
	
	-- Body text
	create("TextLabel", {
		Name = "Body",
		Parent = notification,
		BackgroundTransparency = 1,
		Position = UDim2.new(0, 68, 0, 44),
		Size = UDim2.new(1, -88, 0, 40),
		Font = Enum.Font.Gotham,
		Text = body,
		TextColor3 = Color3.fromRGB(161, 161, 170),
		TextSize = 14,
		TextWrapped = true,
		TextXAlignment = Enum.TextXAlignment.Left,
		TextYAlignment = Enum.TextYAlignment.Top
	})
	
	-- Close button
	local closeBtn = create("TextButton", {
		Name = "CloseButton",
		Parent = notification,
		BackgroundTransparency = 1,
		Position = UDim2.new(1, -36, 0, 8),
		Size = UDim2.new(0, 28, 0, 28),
		Font = Enum.Font.GothamBold,
		Text = "Ã—",
		TextColor3 = Color3.fromRGB(161, 161, 170),
		TextSize = 24
	})
	
	-- Close button hover effect
	closeBtn.MouseEnter:Connect(function()
		closeBtn.TextColor3 = Color3.fromRGB(250, 250, 250)
	end)
	
	closeBtn.MouseLeave:Connect(function()
		closeBtn.TextColor3 = Color3.fromRGB(161, 161, 170)
	end)
	
	-- Animation and auto-dismiss
	local function dismissNotification()
		notification:TweenPosition(
			UDim2.new(1.1, 0, 0.02, 0),
			Enum.EasingDirection.In,
			Enum.EasingStyle.Back,
			CONFIG.SLIDE_TIME,
			true,
			function()
				screenGui:Destroy()
			end
		)
	end
	
	-- Close button handler
	closeBtn.MouseButton1Click:Connect(dismissNotification)
	
	-- Slide in animation
	notification:TweenPosition(
		UDim2.new(1, -400, 0.02, 0),
		Enum.EasingDirection.Out,
		Enum.EasingStyle.Back,
		CONFIG.SLIDE_TIME
	)
	
	-- Auto-dismiss after duration
	task.delay(CONFIG.DURATION, dismissNotification)
	
	return NotificationLibrary
end

return NotificationLibrary
